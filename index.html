<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
    <title>Noah</title>
    <style>
        body {
			background-color: #f5f5f5;
			font-family: Arial, sans-serif;
			margin: 0;
			padding: 20px;
			min-height: 100vh;
		}

		.title-container {
			text-align: center;
			margin-bottom: 20px;
		}

		.title-container h2 {
			margin: 0;
			color: #1e293b;
			font-size: 24px;
		}

		.column {
			border: 2px solid #e0e0e0;
			padding: 15px;
			margin-bottom: 15px;
			border-radius: 12px;
			background-color: white;
			box-shadow: 0 2px 4px rgba(0,0,0,0.05);
		}

		.column-header {
			font-size: 1.1em;
			font-weight: 600;
			color: #1e293b;
			margin-bottom: 15px;
			padding: 8px;
			background: #e2e8f0;
			border-radius: 6px;
			text-align: center;
		}

		.item {
			margin: 8px 0;
			padding: 12px 15px;
			background-color: #f8f9fa;
			border: 1px solid #e9ecef;
			border-radius: 8px;
			cursor: pointer;
			user-select: none;
			transition: all 0.2s ease;
			position: relative;
		}

		.item:active {
			transform: scale(0.98);
		}

		.item.selected {
			background-color: #bfdbfe;
			border-color: #3b82f6;
		}

		.item.selected::after {
			content: '👈';
			position: absolute;
			right: 10px;
			top: 50%;
			transform: translateY(-50%);
		}

		.item.paired {
			display: none;
		}

		.pair-container {
			margin: 15px 0;
			position: relative;
			padding-left: 25px;
		}

		.pair-number {
			position: absolute;
			left: 0;
			top: 50%;
			transform: translateY(-50%);
			width: 20px;
			height: 20px;
			background: #64748b;
			color: white;
			border-radius: 50%;
			display: flex;
			align-items: center;
			justify-content: center;
			font-size: 12px;
		}

		.pair-slot {
			border-radius: 8px;
			transition: all 0.3s ease;
		}

		.pair-slot.empty {
			border: 2px dashed #cbd5e1;
			min-height: 50px;
			display: flex;
			align-items: center;
			justify-content: center;
			background-color: #f8fafc;
		}

		.pair-slot.empty::before {
			content: '⬇️';
			font-size: 24px;
			opacity: 0.5;
		}

		.pair-slot.highlight {
			border-color: #3b82f6;
			background-color: #eff6ff;
			animation: pulse 1.5s infinite;
		}

		.pair-slot.filled {
			border: 2px solid #bfdbfe;
			background-color: white;
			padding: 10px;
		}

		.pair-slot.correct {
			background-color: #f0fdf4;
			border-color: #4ade80;
		}

		.pair-slot.incorrect {
			background-color: #fef2f2;
			border-color: #f87171;
		}

		.button {
			display: block;
			width: 100%;
			max-width: 300px;
			margin: 10px auto;
			padding: 12px;
			border: none;
			border-radius: 8px;
			font-size: 16px;
			cursor: pointer;
			transition: all 0.2s ease;
		}

		.check-button {
			background-color: #4CAF50;
			color: white;
		}

		.reset-button {
			background-color: #ef4444;
			color: white;
		}

		.completed {
			pointer-events: none;
		}

		@keyframes pulse {
			0% { transform: scale(1); }
			50% { transform: scale(1.02); }
			100% { transform: scale(1); }
		}

		@keyframes flashBorder {
			0% { border-color: #e0e0e0; }
			50% { border-color: #3b82f6; border-width: 3px; }
			100% { border-color: #e0e0e0; }
		}

		.flash-animation {
			animation: flashBorder 1.5s ease infinite;
		}

		.hint-text {
			text-align: center;
			color: #3b82f6;
			font-size: 14px;
			margin-bottom: 15px;
			opacity: 0;
			transition: opacity 0.3s ease;
		}

		.hint-text.show {
			opacity: 1;
		}

		.hint-text.pair-hint {
			margin-top: 10px;
			margin-bottom: -5px;
		}
		
		.summary-pair {
			display: flex;
			flex-direction: column;
			gap: 8px;
			margin-bottom: 20px;
			padding: 15px;
			background: white;
			border-radius: 6px;
			box-shadow: 0 1px 3px rgba(0,0,0,0.1);
		}

		.summary-pair-left {
			padding: 10px;
			background: #e2e8f0;
			border-radius: 6px;
			font-weight: bold;
			color: #1e293b;
		}

		.summary-pair-arrow {
			color: #64748b;
			text-align: center;
			font-size: 1.2em;
		}

		.summary-pair-right {
			padding: 10px;
			background: #f1f5f9;
			border-radius: 6px;
			line-height: 1.5;
		}

		.summary-section {
			margin-bottom: 30px;
			padding: 20px;
			border: 1px solid #e2e8f0;
			border-radius: 8px;
			background: #f8fafc;
		}

		.summary-section-title {
			font-size: 18px;
			color: #1e293b;
			margin-bottom: 20px;
			padding-bottom: 10px;
			border-bottom: 2px solid #e2e8f0;
			font-weight: bold;
			text-align: center;
		}

		@media screen and (max-width: 768px) {
			body {
				padding: 10px;
			}

			.title-container h2 {
				font-size: 20px;
			}

			.item {
				font-size: 14px;
				padding: 10px;
			}
		}
    </style>
</head>
<body>
    <div class="title-container">
        <h2>Noah</h2>
    </div>

    <button class="button reset-button" onclick="resetGame()">重設</button>

	<div id="leftHint" class="hint-text">👇🏻 按聖經先選擇一個最先發生的情節概況</div>
    <div class="column" id="leftColumn">
        <div class="column-header">概況</div>
        <div id="leftItems">
            <!-- 內容由 JavaScript 生成 -->
        </div>
    </div>

	<div id="rightHint" class="hint-text">👇🏻 然後選擇對應的細節</div>
    <div class="column" id="rightColumn">
        <div class="column-header">細節</div>
        <div id="rightItems">
            <!-- 內容由 JavaScript 生成 -->
        </div>
    </div>

    <div id="pairHint" class="hint-text">⬇️ 依順序放置到以下</div>
    <div id="pairContainer">
        <div class="pair-container">
            <div class="pair-number">1</div>
            <div class="pair-slot empty" onclick="placePair(0)"></div>
        </div>
        <div class="pair-container">
            <div class="pair-number">2</div>
            <div class="pair-slot empty" onclick="placePair(1)"></div>
        </div>
        <div class="pair-container">
            <div class="pair-number">3</div>
            <div class="pair-slot empty" onclick="placePair(2)"></div>
        </div>
    </div>

    <button class="button check-button" onclick="checkAnswers()">檢查</button>
	
	<div id="summaryContainer" style="display: none;" class="summary-container">
		<h2 class="summary-title">總結回顧</h2>
		<div id="summaryContent"></div>
		<button class="button check-button" onclick="location.reload()">重新開始</button>
	</div>
    <script>
        // 題目管理
        const allQuestions = {
            'A': {
                title: "挪亞洪水 - A.審判宣告",
                pairs: [
                    {
                        left: "世人敗壞",
                        right: "終日心裡思念的，盡都是邪惡；耶和華後悔造人，心中憂傷；地充滿強暴",
                        rightWithVerses: "(6:5) 終日心裡思念的，盡都是邪惡 (6:6) 耶和華後悔造人，心中憂傷；(6:11-12) 地充滿強暴"
                    },
                    {
                        left: "滅世審判",
                        right: "神的靈離開，設定120年悔改期；宣告洪水毀滅全地",
                        rightWithVerses: "(6:3) 神的靈離開，設定120年悔改期；(6:13，7:4) 宣告洪水毀滅全地"
                    },
                    {
                        left: "義人蒙恩",
                        right: "挪亞「在神眼前蒙恩」被稱為「義人、完全人」",
                        rightWithVerses: "(6:8) 挪亞「在神眼前蒙恩」；(6:9，7:1) 被稱為「義人、完全人」"
                    }
                ]
            },
            'B': {
                title: "挪亞洪水 - B.救恩預備",
                pairs: [
                    {
                        left: "方舟建造",
                        right: "分房分層設計；具體尺寸與結構",
                        rightWithVerses: "(6:14，6:16) 分房分層設計；(6:15-16) 具體尺寸與結構"
                    },
                    {
                        left: "動物保存",
                        right: "攜帶各類活物；潔淨的七公七母，不潔淨的一公一母；儲備糧食",
                        rightWithVerses: "(6:19-20) 攜帶各類活物；(7:2-3) 潔淨的七公七母，不潔淨的一公一母；(6:21) 儲備糧食"
                    },
                    {
                        left: "最後呼召",
                        right: "挪亞全家進入方舟；神親自關閉方舟門",
                        rightWithVerses: "(7:1，7:13) 挪亞全家進入方舟；(7:16) 神親自關閉方舟門"
                    }
                ]
            },
            'C': {
                title: "挪亞洪水 - C.審判執行",
                pairs: [
                    {
                        left: "洪水降臨",
                        right: "天上淵源裂開；大水氾濫40晝夜",
                        rightWithVerses: "(7:11) 天上淵源裂開；(7:12，17-20) 大水氾濫40晝夜"
                    },
                    {
                        left: "全地滅絕",
                        right: "凡有血肉的盡都死亡；水勢浩大150日",
                        rightWithVerses: "(7:21-23) 凡有血肉的盡都死亡；(7:24) 水勢浩大150日"
                    },
                    {
                        left: "水退記號",
                        right: "鴿子與橄欖葉；鴿子不再返回",
                        rightWithVerses: "(8:10-11) 鴿子與橄欖葉；8:12) 鴿子不再返回"
                    }
                ]
            },
            'D': {
                title: "挪亞洪水 - D.約的確立",
                pairs: [
                    {
                        left: "出舟獻祭",
                        right: "築壇獻燔祭；馨香之氣蒙神悅納；不再因人咒地（因為人從小時開始心中所想的都是邪惡的）",
                        rightWithVerses: "(8:20) 築壇獻燔祭 (8:21) 馨香之氣蒙神悅納；不再因人咒地（因為人從小時開始心中所想的都是邪惡的）"
                    },
					{
                        left: "頒佈命令",
                        right: "賜福繁衍增多生養治理；允許食肉但禁食血；追討流人血者的罪",
                        rightWithVerses: "(9:1，9:7) 賜福繁衍增多生養治理；(9:3-4) 允許食肉但禁食血；(9:5-6) 追討流人血者的罪"
                    },
                    {
                        left: "永約應許",
                        right: "不再以洪水滅世；彩虹之約",
                        rightWithVerses: "(8:21-22，9:11) 不再以洪水滅世；(9:12-17) 彩虹之約"
                    }
                ]
            },
            'E': {
                title: "挪亞洪水 - E.人性軟弱",
                pairs: [
                    {
                        left: "醉酒失態",
                        right: "挪亞栽種葡萄園；醉酒赤身躺臥帳棚",
                        rightWithVerses: "(9:20) 挪亞栽種葡萄園；(9:21) 醉酒赤身躺臥帳棚"
                    },
                    {
                        left: "怎對待羞恥",
                        right: "含「看見父親赤身」並宣揚；閃與雅弗「倒退遮蓋」",
                        rightWithVerses: "(9:22) 含「看見父親赤身」並宣揚；(9:23) 閃與雅弗「倒退遮蓋」"
                    },
                    {
                        left: "咒詛與祝福",
                        right: "迦南受咒詛；閃與雅弗蒙福",
                        rightWithVerses: "(9:25) 迦南受咒詛；(9:26-27) 閃與雅弗蒙福"
                    }
                ]
            }
        };

        // 當前題目追踪
		let currentQuestion = 'A';  // 固定從 A 開始
		let correctPairs = allQuestions[currentQuestion].pairs;
		let selectedLeft = null;
		let selectedRight = null;
		let pairs = [null, null, null];

		function initializeGame() {
			// 更新標題
			document.querySelector('.title-container h2').textContent = allQuestions[currentQuestion].title;
			
			// 初始化項目
			initializeItems();
			shuffleItems();
			setTimeout(startInitialHints, 500);
		}

		function initializeItems() {
			const leftItems = document.getElementById('leftItems');
			const rightItems = document.getElementById('rightItems');
			
			leftItems.innerHTML = '';
			rightItems.innerHTML = '';
			
			correctPairs.forEach(pair => {
				leftItems.innerHTML += `<div class="item" onclick="selectItem(this, 'left')">${pair.left}</div>`;
				rightItems.innerHTML += `<div class="item" onclick="selectItem(this, 'right')">${pair.right}</div>`;
			});
		}

		function startInitialHints() {			
			document.getElementById('leftColumn').classList.add('flash-animation');
			document.getElementById('leftHint').classList.add('show');
			
			document.getElementById('rightColumn').classList.remove('flash-animation');
			document.getElementById('rightHint').classList.remove('show');
		}

		function selectItem(element, side) {
			if (element.classList.contains('paired')) return;

			document.querySelectorAll('.column').forEach(col => {
				col.classList.remove('flash-animation');
			});
			
			document.querySelectorAll('.hint-text').forEach(hint => {
				hint.classList.remove('show');
			});

			document.querySelectorAll(`#${side}Items .selected`).forEach(item => {
				item.classList.remove('selected');
			});

			element.classList.add('selected');
			
			if (side === 'left') {
				selectedLeft = element;
				const rightColumn = document.getElementById('rightColumn');
				const rightHint = document.getElementById('rightHint');
				rightColumn.classList.add('flash-animation');
				rightHint.classList.add('show');
			} else {
				selectedRight = element;
			}

			if (selectedLeft && selectedRight) {
				document.querySelectorAll('.pair-slot.empty').forEach(slot => {
					slot.classList.add('highlight');
				});
				document.querySelectorAll('.column').forEach(col => {
					col.classList.remove('flash-animation');
				});
				const pairHint = document.getElementById('pairHint');
				pairHint.classList.add('show');
			}
		}

		function placePair(index) {
			document.getElementById('pairHint').classList.remove('show');
			
			if (!selectedLeft || !selectedRight) return;

			document.querySelectorAll('.pair-slot').forEach(slot => {
				slot.classList.remove('highlight');
			});

			if (pairs[index]) {
				pairs[index].left.classList.remove('paired');
				pairs[index].right.classList.remove('paired');
			}

			pairs[index] = {
				left: selectedLeft,
				right: selectedRight
			};

			const slot = document.querySelectorAll('.pair-slot')[index];
			slot.innerHTML = `
				<div>${selectedLeft.textContent}</div>
				<div style="margin-top: 10px; color: #666;">⭐</div>
				<div>${selectedRight.textContent}</div>
			`;
			slot.classList.remove('empty');
			slot.classList.add('filled');

			selectedLeft.classList.add('paired');
			selectedRight.classList.add('paired');

			selectedLeft.classList.remove('selected');
			selectedRight.classList.remove('selected');
			selectedLeft = null;
			selectedRight = null;

			// 檢查是否所有slot都已填滿
			const allSlotsFilled = pairs.every(pair => pair !== null);
			
			if (!allSlotsFilled) {
				// 如果還未全部填滿，重新啟動左側提示
				document.getElementById('leftColumn').classList.add('flash-animation');
				document.getElementById('leftHint').classList.add('show');
				
				// 確保右側提示是關閉的
				document.getElementById('rightColumn').classList.remove('flash-animation');
				document.getElementById('rightHint').classList.remove('show');
			} else {
				// 如果已全部填滿，關閉所有提示
				document.getElementById('leftColumn').classList.remove('flash-animation');
				document.getElementById('leftHint').classList.remove('show');
			}
		}

		function checkAnswers() {
			let allCorrect = true;
			let correctCount = 0;

			const allFilled = pairs.every(pair => pair !== null);
			if (!allFilled) {
				alert('請先完成所有配對！');
				return;
			}

			pairs.forEach((pair, index) => {
				if (!pair) {
					allCorrect = false;
					return;
				}

				const isCorrect = 
					pair.left.textContent === correctPairs[index].left && 
					pair.right.textContent === correctPairs[index].right;

				const slot = document.querySelectorAll('.pair-slot')[index];
				
				if (isCorrect) {
					slot.classList.add('correct');
					correctCount++;
				} else {
					slot.classList.add('incorrect');
					allCorrect = false;
				}
			});

			if (allCorrect) {
				pairs.forEach((pair, index) => {
					const slot = document.querySelectorAll('.pair-slot')[index];
					slot.innerHTML = `
						<div>${pair.left.textContent}</div>
						<div style="margin: 10px 0; color: #666;">⭐</div>
						<div>${correctPairs[index].rightWithVerses}</div>
					`;
				});

				document.querySelectorAll('.item').forEach(item => {
					item.classList.add('completed');
					item.onclick = null;
				});

				document.querySelectorAll('.pair-slot').forEach(slot => {
					slot.onclick = null;
				});

				// 只在非E題時才滾動到底部
				if (currentQuestion !== 'E') {
					setTimeout(() => {
						window.scrollTo({
							top: document.documentElement.scrollHeight,
							behavior: 'smooth'
						});
					}, 300);
				}

				const checkButton = document.querySelector('.check-button');
				
				if (currentQuestion === 'E') {
					// 隱藏遊戲界面
					document.querySelectorAll('.column, .pair-container, .progress-container, .reset-button, #leftHint, #rightHint, #pairHint').forEach(el => {
						el.style.display = 'none';
					});
					
					// 修改標題
					document.querySelector('.title-container h2').textContent = '挪亞方舟';
					
					// 生成總結內容
					const summaryContent = document.getElementById('summaryContent');
					summaryContent.innerHTML = '';
					
					// 遍歷所有題目生成總結
					Object.entries(allQuestions).forEach(([key, question]) => {
						const section = document.createElement('div');
						section.className = 'summary-section';
						
						const subtitle = question.title.split(' - ')[1];
						
						section.innerHTML = `
							<div class="summary-section-title">${subtitle}</div>
							${question.pairs.map(pair => `
								<div class="summary-pair">
									<div class="summary-pair-left">${pair.left}</div>
									<div class="summary-pair-arrow">↓</div>
									<div class="summary-pair-right">${pair.rightWithVerses}</div>
								</div>
							`).join('')}
						`;
						
						summaryContent.appendChild(section);
					});
					
					// 顯示總結容器
					document.getElementById('summaryContainer').style.display = 'block';
					
					// 直接滾動到頂部
					window.scrollTo({
						top: 0,
						behavior: 'instant'
					});

					checkButton.textContent = '重新開始';
					checkButton.onclick = () => {
						location.reload();
					};
				} else {
					checkButton.textContent = '答對了！下一題';
					checkButton.onclick = function goToNextQuestion() {
						// 更新當前題目
						currentQuestion = String.fromCharCode(currentQuestion.charCodeAt(0) + 1);
						correctPairs = allQuestions[currentQuestion].pairs;
						
						// 重置所有狀態
						selectedLeft = null;
						selectedRight = null;
						pairs = [null, null, null];

						// 滾動到頂部
						window.scrollTo({
							top: 0,
							behavior: 'smooth'
						});

						// 給滾動一點時間完成
						setTimeout(() => {
							// 清除所有項目
							document.getElementById('leftItems').innerHTML = '';
							document.getElementById('rightItems').innerHTML = '';

							// 更新標題
							document.querySelector('.title-container h2').textContent = allQuestions[currentQuestion].title;

							// 重設所有配對槽
							const slots = document.querySelectorAll('.pair-slot');
							slots.forEach((slot, index) => {
								slot.classList.remove('filled', 'correct', 'incorrect');
								slot.classList.add('empty');
								slot.innerHTML = '';
								slot.onclick = () => placePair(index);
							});

							// 重設檢查按鈕
							checkButton.textContent = '檢查';
							checkButton.onclick = checkAnswers;

							// 初始化新題目的項目
							initializeItems();
							shuffleItems();    

							// 重新啟動提示
							setTimeout(startInitialHints, 500);
						}, 300);
					};
				}
			} else {
				setTimeout(() => {
					if (confirm('答案不正確。要重設當前題目再試嗎？')) {
						resetGame();
					}
				}, 500);
			}
		}

		function resetGame() {
			if (confirm('確定要重設當前題目嗎？')) {
				// 重新啟用所有項目的點擊事件
				const leftItems = document.querySelectorAll('#leftItems .item');
				const rightItems = document.querySelectorAll('#rightItems .item');
				
				leftItems.forEach(item => {
					item.classList.remove('paired', 'selected', 'completed');
					item.onclick = () => selectItem(item, 'left');
				});
				
				rightItems.forEach(item => {
					item.classList.remove('paired', 'selected', 'completed');
					item.onclick = () => selectItem(item, 'right');
				});

				// 清除所有配對槽並重新綁定點擊事件
				const slots = document.querySelectorAll('.pair-slot');
				slots.forEach((slot, index) => {
					slot.classList.remove('filled', 'correct', 'incorrect');
					slot.classList.add('empty');
					slot.innerHTML = '';
					slot.onclick = () => placePair(index);
				});

				// 重設選擇狀態
				selectedLeft = null;
				selectedRight = null;
				pairs = [null, null, null];

				// 重設檢查按鈕
				const checkButton = document.querySelector('.check-button');
				checkButton.textContent = '檢查';
				checkButton.onclick = checkAnswers;

				// 重新洗牌
				shuffleItems();
				
				// 重新啟動初始提示
				setTimeout(startInitialHints, 500);
			}
		}

		function shuffleItems() {
			const leftItems = document.getElementById('leftItems');
			const rightItems = document.getElementById('rightItems');
			
			// 洗牌左側項目
			Array.from(leftItems.children)
				.sort(() => Math.random() - 0.5)
				.forEach(item => {
					leftItems.appendChild(item);
					// 確保點擊事件存在
					item.onclick = () => selectItem(item, 'left');
				});
			
			// 洗牌右側項目
			Array.from(rightItems.children)
				.sort(() => Math.random() - 0.5)
				.forEach(item => {
					rightItems.appendChild(item);
					// 確保點擊事件存在
					item.onclick = () => selectItem(item, 'right');
				});
		}

		document.addEventListener('DOMContentLoaded', () => {
			// 確保所有配對槽都有正確的點擊事件
			const slots = document.querySelectorAll('.pair-slot');
			slots.forEach((slot, index) => {
				slot.onclick = () => placePair(index);
			});
			
			initializeGame();
		});
    </script>
</body>
</html>
